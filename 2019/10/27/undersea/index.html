<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="Full Demo: Youtube link, Code
Project Description &amp;amp; OverviewCreating a 3D game in OpenGL is both challenging and rewarding. There are many resourc">
    

    <!--Author-->
    
        <meta name="author" content="Xuefei Li">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Undersea Game"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="XuefeiLi(李雪霏)"/>

    <!--Page Cover-->
    
        <meta property="og:image" content=""/>
    

    <!-- Title -->
    
    <title>Undersea Game - XuefeiLi(李雪霏)</title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/reset.css">

    
<link rel="stylesheet" href="/css/main.css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


    <!--Favicon-->
    
        <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Menu -->
<!-- Navigation -->
<header>
    <div class="logo">
        <a href="/">XuefeiLi(李雪霏)</a>
    </div><!-- end logo -->

    <div id="menu_icon"></div>
    <nav>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives">Archives</a>
            </li>
            
        </ul>
    </nav><!-- end navigation menu -->

</header><!-- end header -->


<!-- Main Content -->
<section class="main clearfix">

    <section class="top" style="background: url('/assets/header.jpeg');">
        <div class="wrapper content_header clearfix">
            

<div class="work_nav">

    <ul class="btn clearfix">
        
        <li><a href="/2019/11/02/Food-web-visualization/" class="previous" data-title="Food web visualization"></a></li>
        
        <li><a href="/" class="grid" data-title="Portfolio"></a></li>
        
        <li><a href="/2019/10/09/Dempost/" class="next" data-title="Dempost"></a></li>
        
    </ul>

</div><!-- end work_nav -->
            <h1 class="title">Undersea Game</h1>
        </div>
    </section><!-- end top -->

    <section class="wrapper">
        <div class="content">

            <!-- Gallery -->
            

            <!-- Content -->
            <p><img src="/assets/undersea/undersea2.gif" alt="undersea2"></p>
<p>Full Demo: <a href="https://www.youtube.com/watch?v=P3lN6DseqMA&t" target="_blank" rel="noopener">Youtube link</a>, <a href="https://github.com/SnowflyLXF/Computer-Graphics-Practices/tree/master/underseaGame" target="_blank" rel="noopener">Code</a></p>
<h3 id="Project-Description-amp-Overview"><a href="#Project-Description-amp-Overview" class="headerlink" title="Project Description &amp; Overview"></a>Project Description &amp; Overview</h3><p>Creating a 3D game in OpenGL is both challenging and rewarding. There are many resources and libraries available to create a very realistic and high-end video game. I made use of OpenGL and SDL library to create a 3D adventure game that is set undersea. This game requires navigating through a 3D virtual scene to catch jellyfishes meanwhile avoid sharks to reach the goal. By implementing advanced features, the overall game play quality went up as well as the look and feel of the game.<br>My goal is to create a realistic undersea world. The major task is to make the scene realistic. I need to implement complex objects and textures in the scene as well as special effects like shadows, fog and caustic. Another obstacle is to add text to the game. Moreover, a smooth motion of the character by keyboard input and a friendly menu with a mini-map will add to a better experience.</p>
<h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><ol>
<li>Rendering Pipeline is the sequence of steps that OpenGL takes when rendering objects. Vertex attribute and other data go through a sequence of steps to generate the final image on the screen. First apply transform in 3D world coordinate system, next add illuminate according to lighting and reflectance. Then transform into 3D camera coordinate system, then 2D screen coordinate system, Clip primitives outside camera’s view. Finally, draw Pixels, also texturing.<br>I use glTranslatef and glRotatef for matrix transformation. I also apply the perspective switch by F2 to show the transformation:</li>
</ol>
<p><img src="/assets/undersea/undersea3.png" alt="undersea3"></p>
<ol start="2">
<li>Lights I used include ambient light, which a scene-wide global ambient light to be applied to all primitives; directional light that models point light at infinity at certain direction; spotlight as a headlight that falls out smoothly and cut off. The images below show the effect of spotlight, you can turn it off by F3.</li>
</ol>
<p><img src="/assets/undersea/undersea4.png" alt="undersea4"></p>
<ol start="3">
<li>Shadow is also very important to detect objects around. It is created by projection from the 3D project to the ground turning the projection to a fixed dark color. The projection is scaled a little to make it bigger when it gets closer to the ground. You can turn it off by F5 if you don’t like it.</li>
</ol>
<p><img src="/assets/undersea/undersea5.png" alt="undersea5"></p>
<ol start="4">
<li>For the color of the scene, I use Gouraud shading model that calculates the surface normals at the vertices of polygons in a 3D computer model. These normals are then averaged for all the polygons that meet at each point. Lighting computations are then performed to produce color intensities at vertices.<br>Also the reflections and refractions. One of the special effects of water is caustic, referring to patches of light or their bright edges. It is caused by light rays reflected or refracted by a curved surface or object, or the projection of that envelope of rays on another surface. I create this effect by adding 3 layers of texture to the sea bottom. You can also turn off the effect by F4.</li>
</ol>
<p><img src="/assets/undersea/undersea6.png" alt="undersea6"></p>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><p>Build on Ubuntu 16.04. Install dependencies: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install libsdl2-dev</span><br><span class="line">$ sudo apt-get install libsdl2-ttf-dev</span><br><span class="line">$ sudo apt-get install libsdl2-image-dev</span><br></pre></td></tr></table></figure>

<p>Download the files,  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/SnowflyLXF/OpenGL-3D-game.git</span><br></pre></td></tr></table></figure>

<p>run the makefile inside the source code folder,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> OpenGL-3D-game/project/src</span><br><span class="line">$ make</span><br></pre></td></tr></table></figure>

<p>run the executable file to start the game:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./Undersea</span><br></pre></td></tr></table></figure>

<h3 id="Manual-control"><a href="#Manual-control" class="headerlink" title="Manual control"></a>Manual control</h3><ol>
<li>Startup</li>
</ol>
<p>Once you start the game, a tutorial appears for 10s then disappears(see tutorial.cpp). As you can see from the image, there is a stopwatch showing the remaining time (starting at 90s), a scoreboard showing accumulative scores up till now, and a mini-map at the left bottom corner, showing the position of sharks (marked by red spot) and jellyfishes (marked by blue spot)(see minimap.cpp). I use SDL-TTF to render text, the font is Oswald-bold(see textrender.cpp).</p>
<p><img src="/assets/undersea/undersea1.png" alt="undersea1"></p>
<ol start="2">
<li>Control</li>
</ol>
<p>Direction Keys:</p>
<p>Key ‘w’: Move forward, Key ‘s’: Move backward</p>
<p>Key ‘q’: Move upward, Key ‘e’: Move downward</p>
<p>Key ‘a’: Turn left, Key ‘d’: Turn right</p>
<p>Other:</p>
<p>Key ‘ESC’: Terminate the game</p>
<p>key SPACE: Accelerate</p>
<p>F1: Help  F2: switch perspective F3: Headlight  F4: Reflection  F5: Shadow</p>
<p>In order to move more smoothly and realistically, I apply Newton’s law of Motion to the object. F=ma, taking friction in water into account F=-f (f for friction, which is set to constant, see Patrick.h). Speed will decrease to zero if no extra force is imposed, Δv = a. If Space is pressed, you will obtain acceleration in the moving direction. “Turbo” will appears on the top right corner. Notice that you can only use this function once in 5s. The velocity and acceleration are calculated as vector and are updated with the control system(see Dostep function in Patrick.cpp).</p>
<ol start="3">
<li>Collision Detection</li>
</ol>
<p>Since there are various objects located in the game, the implementation of collision detection is required to detect when the player the items. Each object is bounded by a rectangular box–bounding box(in Mesh.cpp ComputeBoundingBox). A collision is detected when the volumes of the two objects’ boxes intercept one another. The condition for a collision is: for each dimension (i.e. x,y,z), there is an overlap between the space occupied by object 1 and object 2 in that dimension. Once you collide with a jellyfish, you will gain 10 points, Once you collide with a shark, game over.</p>
<h3 id="Game-Design"><a href="#Game-Design" class="headerlink" title="Game Design"></a>Game Design</h3><p>In creating the game, many different OpenGL programming techniques are used for drawing and viewing objects and adding special effects.</p>
<ol>
<li>Characters</li>
</ol>
<p>Items in the game are drawn with different shapes which are loaded from obj files(). They comprise of triangle meshes. The mesh components are vertices, edges and triangles. First read all the vertices, normals, texcoords &amp; triangles into the allocated arrays. Then use Gouraud shading model that computes the lighting at the corners of each triangle and linearly interpolating the resulting colors for each pixel covered by the triangle. (see mesh.cpp)</p>
<p><img src="/assets/undersea/undersea7.png" alt="undersea7"></p>
<p>Patrick is the major character of the game that represents the player. The game uses a first-person view, so you can only see the back of him.<br>Jellyfish is the bonus(see Jellyfish.cpp). They are generated randomly. A new jellyfish is added every 3s in random position at the same height, and falling at a certain speed, it disappears beneath the ground(see JellyManager.cpp). Notice that jellyfish is translucent, to create the effect, I use blend function of OpenGL to decrease the alpha value of the object to allow some light to travel through jellyfishes.</p>
<p><img src="/assets/undersea/undersea8.png" alt="undersea8"></p>
<p>Shark is the villian, there are 3 sharks in total moving towards you at a certain speed(see Enemy.cpp, EnemyManager.cpp). Other objects like seaweed and starfish at sea bottom are for decoration (see Map.cpp).<br>Transformation functions including glRotatef and glTranslatef are applied to each object.</p>
<ol start="2">
<li>Camera</li>
</ol>
<p>The camera in the game is defined with the gluLookAt function. Throughout the main part of the game, the player explores the maze in the first-person view. He is able to look around the maze from his current position by using keyboard. This was done with SDL_Keycode which allows the game to record keyboard input.</p>
<ol start="3">
<li>Lighting and Material Variation</li>
</ol>
<p>Light sources, namely, specular, diffuse and ambient, are set. The light sources settings are initialized with the function glLightfv. These light sources are created with the code below(a direction light).<br>The diffuse light is used to define the bright areas of the object and the ambient light defines the color of the object.</p>
<p>Another effect is fog by glFog.</p>
<ol start="4">
<li>Texture Mapping</li>
</ol>
<p>In designing the game, we used the technique of texture mapping in order to provide a professional touch to our graphics. Texture mapping is the process of coloring pixels based on an image. In our game, we used bitmaps as our textures and mapped them to different objects in the game.</p>
<p><img src="/assets/undersea/undersea9.png" alt="undersea9"></p>
<h3 id="Future-Work"><a href="#Future-Work" class="headerlink" title="Future Work"></a>Future Work</h3><ol>
<li><p>Add more characters like different fish as enemy to decrease your score or bonus to increase score. For example, collision with octopus-lose 10 points; collision with barracuda-gain 5 points.</p>
</li>
<li><p>Procedurally generate levels</p>
</li>
<li><p>Add more functions like attacking the enemy</p>
</li>
<li><p>Simulate the water effect of flow as well as seaweed and jellyfish floating with the flow to make it more realistic</p>
</li>
<li><p>create an intelligent agent that plays the game automatically</p>
</li>
</ol>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3>

            <!-- Tags -->
            


<div class="tags">
    <a href="/tags/C-OpenGL-3D-game/">C++, OpenGL, 3D, game</a>
</div>



            <!-- Comments -->
            <div>
                




            </div>
        </div><!-- end content -->
    </section>
</section><!-- end main -->

<!-- After footer scripts -->

<!-- jQuery -->

<script src="/js/jquery.js"></script>


<!-- Custom Code -->

<script src="/js/main.js"></script>


<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>

</html>